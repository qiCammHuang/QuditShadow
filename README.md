# QuditShadow
A MATLAB+Python demo for classical shadow on Qudits.

For more information of the theoretical aspects of this code, please refer to the paper xxx.



## Get Started

Download the source code, and save the unzipped folder ```QuditShadow-main``` under your local MATLAB directory.

You have to first make sure that your MATLAB has successfully loaded a python executable. See the next section.

Run ```main_highdim.m``` in the ```QuditShadow-main``` directory to obtain statistical results generated by *Unbiased Shadow*, *Locally-biased Shadow*, *Derandomisation* and *Locally-biased Derandomisation*.

Be careful to set parameters coherently in ```main_highdim.m``` for every run. Mainly, there are

```matlab
%% Parameter settings and Initialisation
% ------ To Set for Every Run ------
Nq = 4; % number of qudits
dim = 2; % qudit dimension. 2 for qubit, 3 for qutrit, ...
fid = 'simpleHamil.txt'; % txt file for Hamiltonian, or other set of observables

% Data generation mode
mode_data = 1;
% 0: Experiment mode (TODO), read & load quantum state info from experimental data
% 1: Theoretical mode, derive from ideal quantum pure state (in our case, GHZ)
% -----------------------------------
```

and

```matlab
%% Error vs number of Samples

% ------ To Set for Every Run ------
Sample_list = [200, 400, 600, 800, 1000, 1200, 1400, 1600, 1800, 2000];
L = 20; % independent repetitions

% LBCS optimisation
beta_dis = get_beta(1000, 0.01, dim); % Minimises Variance
% -----------------------------------
```

Very importantly, the txt Hamiltonian files need to be preserved in exactly the following format, which we call the {{observ_matlab}} format,

```matlab
% the {{observ_matlab}} format, observables are expressed as
% e.g. {{observ.txt}}
% 
% 0  3  7  0  0.2452102298125
% 0  0  4  8  0.1412847218385
% ...
%
```

This allows the user to customize Hamiltonians of interest.

---

To extract the statistical outcome of the simulation, refer to the MATLAB matrices ```AllErrMean```,  ```AllErrVar``` , ```MaxErrMean```, ```MaxErrVar``` for data. They have as many rows as ```size(Sample_list, 2)```, and exactly 4 columns, corresponding to *Unbiased Shadow*, *Locally-biased Shadow*, *Derandomisation* and *Locally-biased Derandomisation*, respectively.

```AllErrMean``` represents the overall error of estimation of $O = \sum_{l}\alpha_l O_l$

```matlab
AllErrMean =

    0.1828    0.1936    0.1582    0.1240
    0.1463    0.1451    0.1004    0.0898
    0.0886    0.0819    0.0791    0.0624
    0.0733    0.0925    0.0643    0.0818
    0.0757    0.0828    0.0692    0.0652
    0.0657    0.0824    0.0676    0.0704
    0.0763    0.0536    0.0430    0.0462
    0.0584    0.0460    0.0592    0.0513
    0.0498    0.0632    0.0510    0.0546
    0.0500    0.0779    0.0480    0.0371
```

and

```AllErrVar``` represents the variance of each ```AllErrMean``` entry, taken from the ```L``` independent experiments.

```matlab
AllErrVar =

    0.1216    0.1192    0.1044    0.0906
    0.1019    0.1255    0.0756    0.0568
    0.0682    0.0661    0.0407    0.0466
    0.0811    0.0623    0.0615    0.0434
    0.0567    0.0482    0.0423    0.0365
    0.0580    0.0499    0.0505    0.0329
    0.0453    0.0480    0.0314    0.0389
    0.0396    0.0367    0.0335    0.0271
    0.0357    0.0443    0.0398    0.0354
    0.0412    0.0459    0.0349    0.0274
```

---

Likewise, for maximal error of estimation per "observable" term, there is

```matlab
MaxErrMean =

    0.4595    0.4452    0.3471    0.3644
    0.3186    0.3294    0.2495    0.2482
    0.2475    0.2414    0.2103    0.2013
    0.2266    0.2065    0.1779    0.1588
    0.1876    0.1863    0.1648    0.1447
    0.1797    0.1754    0.1487    0.1406
    0.1702    0.1700    0.1234    0.1373
    0.1587    0.1401    0.1268    0.1349
    0.1397    0.1520    0.1098    0.1200
    0.1403    0.1444    0.1147    0.1032
```

indicating the maximum error among all observables in each method.

```matlab
MaxErrVar =

    0.1283    0.1447    0.1025    0.0954
    0.0840    0.0929    0.0834    0.0533
    0.0616    0.0508    0.0606    0.0453
    0.0467    0.0336    0.0617    0.0391
    0.0436    0.0537    0.0381    0.0309
    0.0361    0.0438    0.0309    0.0431
    0.0520    0.0465    0.0247    0.0304
    0.0312    0.0262    0.0291    0.0257
    0.0260    0.0339    0.0244    0.0298
    0.0249    0.0330    0.0320    0.0228
```

and correspondingly their variance, taken from independent experiments.



## Python related usage

Before running ```main_highdim.m```, make sure that your MATLAB has successfully loaded a python executable. You could check by using the ```pyversion``` command. For example,

```matlab
>> pyversion

       version: '3.7'
    executable: '/Users/user/opt/anaconda3/envs/classicalShadow/bin/python3.7'
       library: '/Users/user/opt/anaconda3/envs/classicalShadow/lib/libpython3.7m.dylib'
          home: '/Users/user/opt/anaconda3/envs/classicalShadow'
      isloaded: 1
```

If python is not readily loaded, use
```matlab
>> pyversion('/Users/user/opt/anaconda3/envs/classicalShadow/bin/python3.7')
```


If changes are made to python files, MATLAB would not immediately execute the new programme. Instead, in our case, do

```matlab
% Reload Python module
clear classes
obj = py.importlib.import_module('derandTools');
py.importlib.reload(obj);
```

so that MATLAB can run the renewed python files.

